package com.pluralsight.repository;

import java.util.Date;
import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import com.pluralsight.model.Flight;
import com.pluralsight.model.FlightsReport;

@Repository("flightSearchRepository")
public interface FlightSearchRepository extends JpaRepository<Flight, Integer> {

		
	@Query("Select new com.pluralsight.model.FlightsReport( r.destination_id, r.source_id, r.miles, f.date, f.departure_time, f.arrival_time, f.seat_matrix.vacant, f.seat_matrix.price) " +  
			"from SubFlight f, Route r, SeatMatrix sm, SeatType st where f.route_id = r.route_id and sm.seat_type = st.seat_type " +
			"and sm.seat_type.seat_type = ?4")
	List<FlightsReport> findAllFlights(String source_airport, String destination_airport, Date date,
			String seat_class, int seats);

	
}
